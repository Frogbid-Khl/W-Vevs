!function(e,t){var n,i,r,o=/\.com$/.test(window.location.hostname),a="localhost"===window.location.hostname,c=o?"/":"/vevs_com/",s=document.getElementById("subscriptionButton");function u(){return navigator.serviceWorker.ready.then((async function(e){const t=await fetch(c+"push-manager/pubkey/?uuid="+n+"&cid="+i,{method:"get",headers:{"X-Requested-With":"XMLHttpRequest"}}),r=function(e){for(var t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(n),r=new Uint8Array(i.length),o=0;o<i.length;++o)r[o]=i.charCodeAt(o);return r}((await t.json()).publicKey);return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r}).catch((function(e){p()}))})).then((function(e){if(!e)return;const t=(r=e.options.applicationServerKey,btoa(String.fromCharCode.apply(null,new Uint8Array(r))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""));var r;return fetch(c+"push-manager/register/?uuid="+n+"&cid="+i,{method:"post",headers:{"Content-type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({subscription:e,publicKey:t})})})).then(g).catch((function(e){}))}function d(){return navigator.serviceWorker.ready.then((function(e){return e.pushManager.getSubscription()})).then((function(e){return e.unsubscribe().then((function(){return fetch(c+"push-manager/unregister/?uuid="+n+"&cid="+i,{method:"post",headers:{"Content-type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({subscription:e})})}))})).then(f)}function h(){r.prop("disabled",!1).parent(".hidden").removeClass("hidden")}function p(){r.prop("disabled",!0).parent(".hidden").addClass("hidden")}function f(){arguments.length?arguments[0]?(arguments[0].text(),h()):p():h(),s.onclick=u,s.classList.add("active")}function g(){arguments.length?arguments[0]?(arguments[0].text(),h()):p():h(),s.onclick=d,s.classList.remove("active")}s&&(r=e(s),n=r.data("uuid"),i=r.data("cid")),"serviceWorker"in navigator&&(o||a)&&navigator.serviceWorker.register(c+"sw.js",{updateViaCache:"none"}).then((function(e){void 0!==n&&navigator.serviceWorker.ready.then((function(e){return e.pushManager.getSubscription()})).then((function(e){if(e)return fetch(c+"push-manager/synchronize/?uuid="+n+"&cid="+i,{method:"post",headers:{"Content-type":"application/json","X-Requested-With":"XMLHttpRequest"},body:JSON.stringify({subscription:e})})})).then((function(e){if(e)return e.json()})).then((function(e){e&&e.status&&"ERR"===e.status&&101===e.code&&d().then((function(){u()}))})).then((function(){s&&navigator.serviceWorker.ready.then((function(e){return e.pushManager.getSubscription()})).then((function(e){"denied"!==Notification.permission&&(e?g():f())}))}))}),(function(e){}))}(jQuery);